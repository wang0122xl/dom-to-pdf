var we=Object.defineProperty,Ee=Object.defineProperties;var xe=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var ie=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var q=(s,e,n)=>e in s?we(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n,oe=(s,e)=>{for(var n in e||(e={}))ie.call(e,n)&&q(s,n,e[n]);if(j)for(var n of j(e))re.call(e,n)&&q(s,n,e[n]);return s},se=(s,e)=>Ee(s,xe(e));var U=(s,e)=>{var n={};for(var t in s)ie.call(s,t)&&e.indexOf(t)<0&&(n[t]=s[t]);if(s!=null&&j)for(var t of j(s))e.indexOf(t)<0&&re.call(s,t)&&(n[t]=s[t]);return n};var _=(s,e,n)=>(q(s,typeof e!="symbol"?e+"":e,n),n);import{E as Te,t as Pe,r as Se,j as v,a as c,B as ae,R as ve,b as Ce}from"./vendor.d569c6c0.js";const Ne=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))t(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&t(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerpolicy&&(r.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?r.credentials="include":i.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function t(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}};Ne();const Le="modulepreload",le={},Fe="/dom-to-pdf/",Be=function(e,n){return!n||n.length===0?e():Promise.all(n.map(t=>{if(t=`${Fe}${t}`,t in le)return;le[t]=!0;const i=t.endsWith(".css"),r=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${t}"]${r}`))return;const a=document.createElement("link");if(a.rel=i?"stylesheet":Le,i||(a.as="script",a.crossOrigin=""),a.href=t,document.head.appendChild(a),i)return new Promise((m,d)=>{a.addEventListener("load",m),a.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${t}`)))})})).then(()=>e())},ce={width:210,height:297},Re=s=>s.classList.contains("pdf-seperator"),Ae=s=>s.classList.contains("pdf-table"),k=class{constructor(){_(this,"heitiString")}async loadFont(){const{heitiString:e}=await Be(()=>import("./heiti.2a8baa51.js"),[]);this.heitiString=e}async createPdfIfNotExisted(e,n){let t=n;const i=e||ce;return this.heitiString||await this.loadFont(),t||(t=new Te("p","mm",[i.width,i.height]),t.addFileToVFS("heiti.ttf",this.heitiString),t.addFont("heiti.ttf","heiti","normal"),t.setFont("heiti")),t}async promisifyCreateImage(e){return new Promise(n=>{const t=document.createElement("img");t.src=e,t.onload=function(){n(t)}})}objectIs(e,n){return Object.prototype.toString.call(e)===`[object ${n}]`}recursiveFindClass(e,n,t){return e?this.objectIs(e,n)?e:this.recursiveFindClass(e.parentElement,n,t):null}recursiveFindTagName(e,n,t){return e?e.tagName===n?e:this.recursiveFindTagName(e.parentElement,n,t):null}async pdfAddEle(e){return Promise.resolve().then(()=>{const n=e.element.style.marginTop,t=e.element.style.marginBottom;return e.element.style.marginTop="0",e.element.style.marginBottom="0",Pe(e.element,{quality:1}).then(i=>this.promisifyCreateImage(i)).then(i=>{e.pdf.setPage(e.page),e.element.style.marginTop=n,e.element.style.marginBottom=t;const r=document.createElement("canvas");r.width=i.width*2,r.height=i.height*2;const a=r.getContext("2d");a.fillStyle="#fff",a.fillRect(0,0,r.width,r.height),a.drawImage(i,0,0,r.width,r.height);const m=r.toDataURL("image/jpeg",1);e.pdf.addImage(m,"JPEG",e.left,e.top,e.width,e.height)})})}async transformToPdf(e){if(!e.element)throw console.error("element is "+e.element),"element is "+e.element;const n=this;e.element.classList.add(k.TransformingClassName);const{isSeperatorCallback:t=Re,isPdfTableCallback:i=Ae,lastElementOnBottom:r=!0,firstElementAsHeader:a=!0,lastElementAsFooter:m=!0,element:d,size:p=ce,padding:f=[0,0,0,0],renderPageHeader:b,renderPageFooter:w,stickyTableHeader:H=!0,startPage:C=0}=e,F=p.width-f[1]-f[3],$=d.getBoundingClientRect();let y=0;const B=f[3],W=d.children;if(d.children.length<2)throw new Error(`element: ${d} has less than 2 child nodes`);const D=d.children[0],he=d.children[1],Y=d.children[d.children.length-1],fe=d.children[d.children.length-2],{y:R,height:z}=x(D),{y:me,height:A}=x(Y),{y:G,height:Oe}=x(he),{y:ue,height:ge}=x(fe),J=me-ue-ge,pe=G-R-z;let E=1;const u=await this.createPdfIfNotExisted(p,e.pdf);function x(o){const l=o.getBoundingClientRect();return{y:P(l.y),height:P(l.height),width:P(l.width)}}function K(){y=R-P($.y)+f[0]}function P(o){return p.width/$.width*o}function ye(o){const l=o===D,h=o===Y,T=x(o);let g=T.height+f[0]+f[2];if(a&&!l&&(g+=z+R-P($.y)+pe),m&&!h&&(g+=J+A),g>p.height)throw console.error(o),new Error("element \u8D85\u51FApdf\u6700\u5927\u9AD8\u5EA6");let S=y+T.height+f[2];return m&&(S+=A+J),p.height-S}function Q(o,l,h){if(m&&N.push(o.pdfAddEle({pdf:u,element:Y,top:X,left:B,width:F,height:A,page:E+C})),E++,u.addPage(),K(),b==null||b(u,E),w==null||w(u,E),a&&(N.push(o.pdfAddEle({pdf:u,element:D,top:y,left:B,width:F,height:z,page:E+C})),y+=G-R),l&&o.objectIs(h,"HTMLTableRowElement")&&H&&!!!o.recursiveFindTagName(h,"THEAD",h)){const g=o.recursiveFindClass(h,"HTMLTableElement",h),S=g.querySelector("thead > tr"),M=g.querySelector("tbody > tr"),{y:ee,height:te}=x(S),{y:I}=x(M);N.push(o.pdfAddEle({pdf:u,element:S,top:y,left:B,width:F,height:te,page:E+C})),y+=I-ee}}K();const N=[],X=p.height-f[2]-A;function Z(o,l,h,T,g){const{height:S,y:M}=x(o);if(Object.prototype.toString.call(o)==="[object HTMLTableElement]"&&i(o)){let ne;const L=o.querySelectorAll("tr");l<h.length-1&&(ne=P(h[l+1].getBoundingClientRect().y-L[L.length-1].getBoundingClientRect().y));for(let O=0;O<L.length;O++){const be=L[O];Z(be,O,L,!0,ne)}return}ye(o)<0&&Q(n,T,o);let I=y;l<h.length-1?y+=P(h[l+1].getBoundingClientRect().y)-M:T&&(y+=g||0),l===h.length-1&&!T&&(m||r)&&(I=X),N.push(n.pdfAddEle({pdf:u,element:o,top:I,left:B,width:F,height:S,page:E+C})),t(o)&&Q(n)}b==null||b(u,1),w==null||w(u,1);for(let o=0;o<W.length;o++){const l=d.children[o];Z(l,o,W)}return await Promise.all(N),e.element.classList.remove(k.TransformingClassName),{pdf:u,pages:E,doPrint:(o=!0)=>{var g;let l=document.createElement("iframe");l.hidden=!0;const h=URL.createObjectURL(u.output("blob"));l.src=h,(o?window.open():window).document.body.appendChild(l),(g=l.contentWindow)==null||g.print(),URL.revokeObjectURL(h)}}}async transformToPdfs(e){const d=e,{inOnePdf:n=!0,elements:t}=d,i=U(d,["inOnePdf","elements"]),r=[],a=await this.createPdfIfNotExisted(i.size);let m=0;for(let f=0;f<t.length;f++){f>0&&n&&a.addPage();const b=t[f],w=await this.createPdfIfNotExisted(i.size,n?a:void 0),p=await this.transformToPdf(se(oe({},i),{element:b,pdf:w,startPage:n?m:0})),{pages:H}=p,C=U(p,["pages"]);m+=H,r.push(C)}return n?[r[0]]:r}};let V=k;_(V,"TransformingClassName","dom-to-pdf-transforming");const de=s=>{const e=Se.exports.useMemo(()=>{const n=()=>Math.round(Math.random()*255),t=[];for(let i=0;i<11;i++)t.push(`rgb(${n()}, ${n()}, ${n()})`);return t},[]);return v("div",{className:"print-layer a4",id:s.id,children:[c("div",{className:"text-24px h-24px font-500 text-[#333] text-center mt-10px bg-red-400",children:"dom-to-pdf"}),e.map((n,t)=>c("div",{className:"border-1px border-solid border-[#000]",style:{backgroundColor:n,height:"60px",marginTop:5,marginBottom:15,lineHeight:"60px"},children:t},t)),v("table",{className:"pdf-table",children:[c("thead",{children:v("tr",{children:[c("th",{children:"title"}),c("th",{children:"content"}),c("th",{children:"index"})]})}),c("tbody",{children:e.map((n,t)=>v("tr",{children:[c("td",{colSpan:1,children:n}),c("td",{colSpan:1,children:c("div",{className:"w-100px mx-auto h-35px",style:{backgroundColor:n}})}),c("td",{colSpan:1,children:t})]}))})]}),e.map((n,t)=>c("div",{className:"border-1px border-solid border-[#000]",style:{backgroundColor:n,height:"60px",marginTop:5,marginBottom:15,lineHeight:"60px"},children:t},t+"-next")),v("div",{className:"text-15px h-24px font-500 text-[#333] my-10px border-1px border-solid border-[#ccc] border-l-0 border-r-0 py-20px flex items-center justify-between",children:[c("span",{children:"\u8FD9\u662F\u4E00\u4E2Afooter"}),c("span",{children:new Date().toDateString()})]})]})},Ie=()=>{const s=async()=>await new V().transformToPdfs({elements:[document.getElementById("test"),document.getElementById("test1")],padding:[0,10,5,10],renderPageHeader:(r,a)=>{r.setTextColor("#111").setFontSize(8).text(`\u9875\u7709${a}`,10,4)},renderPageFooter:(r,a)=>{r.setTextColor("#111").setFontSize(8).text(`\u7B2C${a}\u9875`,r.internal.pageSize.getWidth()-17,r.internal.pageSize.getHeight()-1)}});return v("div",{id:"print-container",children:[c(de,{id:"test"}),c(de,{id:"test1"}),v("div",{className:"flex justify-center mb-10vh space-x-25px",children:[c(ae,{type:"primary",onClick:async()=>{const t=await s();for(const i of t)i.pdf.save("test")},children:"\u4E0B\u8F7D"}),c(ae,{type:"primary",onClick:async()=>{const t=await s();for(const i of t)i.doPrint(!1)},children:"\u6253\u5370"})]})]})};ve.render(c(Ce.StrictMode,{children:c(Ie,{})}),document.getElementById("root"));
