var Ee=Object.defineProperty,xe=Object.defineProperties;var Pe=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var ie=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var _=(s,e,n)=>e in s?Ee(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n,oe=(s,e)=>{for(var n in e||(e={}))ie.call(e,n)&&_(s,n,e[n]);if(j)for(var n of j(e))re.call(e,n)&&_(s,n,e[n]);return s},se=(s,e)=>xe(s,Pe(e));var q=(s,e)=>{var n={};for(var t in s)ie.call(s,t)&&e.indexOf(t)<0&&(n[t]=s[t]);if(s!=null&&j)for(var t of j(s))e.indexOf(t)<0&&re.call(s,t)&&(n[t]=s[t]);return n};var U=(s,e,n)=>(_(s,typeof e!="symbol"?e+"":e,n),n);import{E as Te,t as Se,r as ve,j as S,a as c,B as ae,R as Ce,b as Fe}from"./vendor.d569c6c0.js";const Ne=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))t(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&t(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function t(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}};Ne();const Le="modulepreload",le={},Be="/dom-to-pdf/",Re=function(e,n){return!n||n.length===0?e():Promise.all(n.map(t=>{if(t=`${Be}${t}`,t in le)return;le[t]=!0;const i=t.endsWith(".css"),o=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${t}"]${o}`))return;const a=document.createElement("link");if(a.rel=i?"stylesheet":Le,i||(a.as="script",a.crossOrigin=""),a.href=t,document.head.appendChild(a),i)return new Promise((f,d)=>{a.addEventListener("load",f),a.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${t}`)))})})).then(()=>e())},ce={width:210,height:297},Ae=s=>s.classList.contains("pdf-seperator"),He=s=>s.classList.contains("pdf-table"),O=class{constructor(){U(this,"heitiString")}async loadFont(){const{heitiString:e}=await Re(()=>import("./heiti.2a8baa51.js"),[]);this.heitiString=e}async createPdfIfNotExisted(e,n){let t=n;const i=e||ce;return this.heitiString||await this.loadFont(),t||(t=new Te("p","mm",[i.width,i.height]),t.addFileToVFS("heiti.ttf",this.heitiString),t.addFont("heiti.ttf","heiti","normal"),t.setFont("heiti")),t}async promisifyCreateImage(e){return new Promise(n=>{const t=document.createElement("img");t.src=e,t.onload=function(){n(t)}})}objectIs(e,n){return Object.prototype.toString.call(e)===`[object ${n}]`}recursiveFindClass(e,n,t){return e?this.objectIs(e,n)?e:this.recursiveFindClass(e.parentElement,n,t):null}recursiveFindTagName(e,n,t){return e?e.tagName===n?e:this.recursiveFindTagName(e.parentElement,n,t):null}async pdfAddEle(e){return Promise.resolve().then(()=>{const n=e.element.style.marginTop,t=e.element.style.marginBottom;return e.element.style.marginTop="0",e.element.style.marginBottom="0",Se(e.element,{quality:1,cacheBust:!0}).then(i=>this.promisifyCreateImage(i)).then(i=>{e.pdf.setPage(e.page),e.element.style.marginTop=n,e.element.style.marginBottom=t;const o=document.createElement("canvas");o.width=i.width*2,o.height=i.height*2;const a=o.getContext("2d");a.fillStyle="#fff",a.fillRect(0,0,o.width,o.height),a.drawImage(i,0,0,o.width,o.height);const f=o.toDataURL("image/jpeg",1);e.pdf.addImage(f,"JPEG",e.left,e.top,e.width,e.height)})})}async transformToPdf(e){if(!e.element)throw console.error("element is "+e.element),"element is "+e.element;const n=this;e.element.classList.add(O.TransformingClassName);const{isSeperatorCallback:t=Ae,isPdfTableCallback:i=He,lastElementOnBottom:o=!0,firstElementAsHeader:a=!0,lastElementAsFooter:f=!0,element:d,size:p=ce,padding:m=[0,0,0,0],renderPageHeader:v,renderPageFooter:C,stickyTableHeader:k=!0,startPage:x=0}=e,L=p.width-m[1]-m[3],$=d.getBoundingClientRect();let y=0;const B=m[3],W=d.children;if(d.children.length<2)throw new Error(`element: ${d} has less than 2 child nodes`);const z=d.children[0],he=d.children[1],D=d.children[d.children.length-1],fe=d.children[d.children.length-2],{y:R,height:Y}=w(z),{y:me,height:A}=w(D),{y:G,height:je}=w(he),{y:ue,height:ge}=w(fe),J=me-ue-ge,pe=G-R-Y;let b=1;const g=await this.createPdfIfNotExisted(p,e.pdf);function w(r){const l=r.getBoundingClientRect();return{y:P(l.top),height:P(l.height),width:P(l.width)}}function K(){y=R-P($.top)+m[0]}function P(r){return p.width/$.width*r}function ye(r){const l=r===z,h=r===D,E=w(r);let u=E.height+m[0]+m[2];if(a&&!l&&(u+=Y+R-P($.top)+pe),f&&!h&&(u+=J+A),u>p.height)throw console.error(r),new Error("element \u8D85\u51FApdf\u6700\u5927\u9AD8\u5EA6");let T=y+E.height+m[2];return f&&(T+=A+J),p.height-T}async function be(r,l){v==null||v(g,r,l),C==null||C(g,r,l)}function Q(r,l,h){if(f&&F.push(r.pdfAddEle({pdf:g,element:D,top:X,left:B,width:L,height:A,page:b+x})),b++,g.addPage(),K(),a&&(F.push(r.pdfAddEle({pdf:g,element:z,top:y,left:B,width:L,height:Y,page:b+x})),y+=G-R),l&&r.objectIs(h,"HTMLTableRowElement")&&k&&!!!r.recursiveFindTagName(h,"THEAD",h)){const u=r.recursiveFindClass(h,"HTMLTableElement",h),T=u.querySelector("thead > tr"),M=u.querySelector("tbody > tr"),{y:ee,height:te}=w(T),{y:H}=w(M);F.push(r.pdfAddEle({pdf:g,element:T,top:y,left:B,width:L,height:te,page:b+x})),y+=H-ee}}K();const F=[],X=p.height-m[2]-A;function Z(r,l,h,E,u){const{height:T,y:M}=w(r);if(Object.prototype.toString.call(r)==="[object HTMLTableElement]"&&i(r)){let ne;const N=r.querySelectorAll("tr");l<h.length-1&&(ne=P(h[l+1].getBoundingClientRect().top-N[N.length-1].getBoundingClientRect().top));for(let I=0;I<N.length;I++){const we=N[I];Z(we,I,N,!0,ne)}return}ye(r)<0&&Q(n,E,r);let H=y;l<h.length-1?y+=P(h[l+1].getBoundingClientRect().top)-M:E&&(y+=u||0),l===h.length-1&&!E&&(f||o)&&(H=X),F.push(n.pdfAddEle({pdf:g,element:r,top:H,left:B,width:L,height:T,page:b+x})),t(r)&&Q(n)}for(let r=0;r<W.length;r++){const l=d.children[r];Z(l,r,W)}await Promise.all(F);for(let r=0;r<b;r++)g.setPage(r+1+x),be(r+1,b);return e.element.classList.remove(O.TransformingClassName),{pdf:g,pages:b,doPrint:(r=!0)=>{var u;let l=document.createElement("iframe");l.hidden=!0;const h=URL.createObjectURL(g.output("blob"));l.src=h,(r?window.open():window).document.body.appendChild(l),(u=l.contentWindow)==null||u.print(),URL.revokeObjectURL(h)}}}async transformToPdfs(e){const d=e,{inOnePdf:n=!0,elements:t}=d,i=q(d,["inOnePdf","elements"]),o=[],a=await this.createPdfIfNotExisted(i.size);let f=0;for(let m=0;m<t.length;m++){m>0&&n&&a.addPage();const v=t[m],C=await this.createPdfIfNotExisted(i.size,n?a:void 0),p=await this.transformToPdf(se(oe({},i),{element:v,pdf:C,startPage:n?f:0})),{pages:k}=p,x=q(p,["pages"]);f+=k,o.push(x)}return n?[o[0]]:o}};let V=O;U(V,"TransformingClassName","dom-to-pdf-transforming");const de=s=>{const e=ve.exports.useMemo(()=>{const n=()=>Math.round(Math.random()*255),t=[];for(let i=0;i<11;i++)t.push(`rgb(${n()}, ${n()}, ${n()})`);return t},[]);return S("div",{className:"print-layer a4",id:s.id,children:[c("div",{className:"text-24px h-24px font-500 text-[#333] text-center mt-10px bg-red-400",children:"dom-to-pdf"}),c("img",{src:"https://rpfield-zlerp.oss-cn-beijing.aliyuncs.com/test/sys_config/image/20210928/152a412d1d00e26020afd9e0f0d0081d.jpg"}),e.map((n,t)=>c("div",{className:"border-1px border-solid border-[#000]",style:{backgroundColor:n,height:"60px",marginTop:5,marginBottom:15,lineHeight:"60px"},children:t},t)),S("table",{className:"pdf-table",children:[c("thead",{children:S("tr",{children:[c("th",{children:"title"}),c("th",{children:"content"}),c("th",{children:"index"})]})}),c("tbody",{children:e.map((n,t)=>S("tr",{children:[c("td",{colSpan:1,children:n}),c("td",{colSpan:1,children:c("div",{className:"w-100px mx-auto h-35px",style:{backgroundColor:n}})}),c("td",{colSpan:1,children:t})]}))})]}),e.map((n,t)=>c("div",{className:"border-1px border-solid border-[#000]",style:{backgroundColor:n,height:"60px",marginTop:5,marginBottom:15,lineHeight:"60px"},children:t},t+"-next")),S("div",{className:"text-15px h-24px font-500 text-[#333] my-10px border-1px border-solid border-[#ccc] border-l-0 border-r-0 py-20px flex items-center justify-between",children:[c("span",{children:"\u8FD9\u662F\u4E00\u4E2Afooter"}),c("span",{children:new Date().toDateString()})]})]})},Ie=()=>{const s=async()=>await new V().transformToPdfs({elements:[document.getElementById("test"),document.getElementById("test1")],padding:[0,10,5,10],renderPageHeader:(o,a)=>{o.setTextColor("#111").setFontSize(8).text(`\u9875\u7709${a}`,10,4)},renderPageFooter:async(o,a,f)=>{o.setTextColor("#111").setFontSize(8).text(`\u7B2C${a}\u9875, \u5171${f}\u9875`,o.internal.pageSize.getWidth()-17,o.internal.pageSize.getHeight()-1)}});return S("div",{id:"print-container",children:[c(de,{id:"test"}),c(de,{id:"test1"}),S("div",{className:"flex justify-center mb-10vh space-x-25px",children:[c(ae,{type:"primary",onClick:async()=>{const t=await s();for(const i of t)i.pdf.save("test")},children:"\u4E0B\u8F7D"}),c(ae,{type:"primary",onClick:async()=>{const t=await s();for(const i of t)i.doPrint(!1)},children:"\u6253\u5370"})]})]})};Ce.render(c(Fe.StrictMode,{children:c(Ie,{})}),document.getElementById("root"));
