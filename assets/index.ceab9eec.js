var wt=Object.defineProperty,Et=Object.defineProperties;var xt=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var nt=Object.prototype.hasOwnProperty,it=Object.prototype.propertyIsEnumerable;var q=(o,t,n)=>t in o?wt(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,rt=(o,t)=>{for(var n in t||(t={}))nt.call(t,n)&&q(o,n,t[n]);if(O)for(var n of O(t))it.call(t,n)&&q(o,n,t[n]);return o},ot=(o,t)=>Et(o,xt(t));var st=(o,t)=>{var n={};for(var e in o)nt.call(o,e)&&t.indexOf(e)<0&&(n[e]=o[e]);if(o!=null&&O)for(var e of O(o))t.indexOf(e)<0&&it.call(o,e)&&(n[e]=o[e]);return n};var _=(o,t,n)=>(q(o,typeof t!="symbol"?t+"":t,n),n);import{E as Tt,t as Pt,r as St,j as v,a as l,B as at,R as vt,b as Ct}from"./vendor.d569c6c0.js";const Nt=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))e(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&e(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerpolicy&&(r.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?r.credentials="include":i.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function e(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}};Nt();const Ft="modulepreload",lt={},Bt="/dom-to-pdf/",Lt=function(t,n){return!n||n.length===0?t():Promise.all(n.map(e=>{if(e=`${Bt}${e}`,e in lt)return;lt[e]=!0;const i=e.endsWith(".css"),r=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const a=document.createElement("link");if(a.rel=i?"stylesheet":Ft,i||(a.as="script",a.crossOrigin=""),a.href=e,document.head.appendChild(a),i)return new Promise((c,d)=>{a.addEventListener("load",c),a.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${e}`)))})})).then(()=>t())},ct={width:210,height:297},At=o=>o.classList.contains("pdf-seperator"),It=o=>o.classList.contains("pdf-table"),j=class{constructor(){_(this,"heitiString")}async loadFont(){const{heitiString:t}=await Lt(()=>import("./heiti.2a8baa51.js"),[]);this.heitiString=t}async createPdfIfNotExisted(t,n){let e=n;const i=t||ct;return this.heitiString||await this.loadFont(),e||(e=new Tt("p","mm",[i.width,i.height]),e.addFileToVFS("heiti.ttf",this.heitiString),e.addFont("heiti.ttf","heiti","normal"),e.setFont("heiti")),e}async promisifyCreateImage(t){return new Promise(n=>{const e=document.createElement("img");e.src=t,e.onload=function(){n(e)}})}objectIs(t,n){return Object.prototype.toString.call(t)===`[object ${n}]`}recursiveFindClass(t,n,e){return t?this.objectIs(t,n)?t:this.recursiveFindClass(t.parentElement,n,e):null}recursiveFindTagName(t,n,e){return t?t.tagName===n?t:this.recursiveFindTagName(t.parentElement,n,e):null}async pdfAddEle(t){return Promise.resolve().then(()=>{const n=t.element.style.marginTop,e=t.element.style.marginBottom;return t.element.style.marginTop="0",t.element.style.marginBottom="0",Pt(t.element,{quality:1}).then(i=>this.promisifyCreateImage(i)).then(i=>{t.pdf.setPage(t.page),t.element.style.marginTop=n,t.element.style.marginBottom=e;const r=document.createElement("canvas");r.width=i.width*2,r.height=i.height*2;const a=r.getContext("2d");a.fillStyle="#fff",a.fillRect(0,0,r.width,r.height),a.drawImage(i,0,0,r.width,r.height);const c=r.toDataURL("image/jpeg",1);t.pdf.addImage(c,"JPEG",t.left,t.top,t.width,t.height)})})}async transformToPdf(t){const n=this;t.element.classList.add(j.TransformingClassName);const{isSeperatorCallback:e=At,isPdfTableCallback:i=It,lastElementOnBottom:r=!0,firstElementAsHeader:a=!0,lastElementAsFooter:c=!0,element:d,size:u=ct,padding:m=[0,0,0,0],renderPageHeader:y,renderPageFooter:b,stickyTableHeader:k=!0,startPage:F=0}=t,B=u.width-m[1]-m[3],$=d.getBoundingClientRect();let p=0;const L=m[3],V=d.children;if(d.children.length<2)throw new Error(`element: ${d} has less than 2 child nodes`);const D=d.children[0],ht=d.children[1],Y=d.children[d.children.length-1],ft=d.children[d.children.length-2],{y:A,height:z}=E(D),{y:ut,height:I}=E(Y),{y:W,height:Ht}=E(ht),{y:mt,height:gt}=E(ft),G=ut-mt-gt,pt=W-A-z;let w=1;const g=await this.createPdfIfNotExisted(u,t.pdf);function E(s){const h=s.getBoundingClientRect();return{y:T(h.y),height:T(h.height),width:T(h.width)}}function J(){p=A-T($.y)+m[0]}function T(s){return u.width/$.width*s}function yt(s){const h=s===D,f=s===Y,P=E(s);let x=P.height+m[0]+m[2];if(a&&!h&&(x+=z+A-T($.y)+pt),c&&!f&&(x+=G+I),x>u.height)throw console.error(s),new Error("element \u8D85\u51FApdf\u6700\u5927\u9AD8\u5EA6");let S=p+P.height+m[2];return c&&(S+=I+G),u.height-S}function K(s,h,f){if(c&&C.push(s.pdfAddEle({pdf:g,element:Y,top:Q,left:L,width:B,height:I,page:w+F})),w++,g.addPage(),J(),y==null||y(g,w),b==null||b(g,w),a&&(C.push(s.pdfAddEle({pdf:g,element:D,top:p,left:L,width:B,height:z,page:w+F})),p+=W-A),h&&s.objectIs(f,"HTMLTableRowElement")&&k&&!!!s.recursiveFindTagName(f,"THEAD",f)){const x=s.recursiveFindClass(f,"HTMLTableElement",f),S=x.querySelector("thead > tr"),M=x.querySelector("tbody > tr"),{y:Z,height:tt}=E(S),{y:R}=E(M);C.push(s.pdfAddEle({pdf:g,element:S,top:p,left:L,width:B,height:tt,page:w+F})),p+=R-Z}}J();const C=[],Q=u.height-m[2]-I;function X(s,h,f,P,x){const{height:S,y:M}=E(s);if(Object.prototype.toString.call(s)==="[object HTMLTableElement]"&&i(s)){let et;const N=s.querySelectorAll("tr");h<f.length-1&&(et=T(f[h+1].getBoundingClientRect().y-N[N.length-1].getBoundingClientRect().y));for(let H=0;H<N.length;H++){const bt=N[H];X(bt,H,N,!0,et)}return}yt(s)<0&&K(n,P,s);let R=p;h<f.length-1?p+=T(f[h+1].getBoundingClientRect().y)-M:P&&(p+=x||0),h===f.length-1&&!P&&(c||r)&&(R=Q),C.push(n.pdfAddEle({pdf:g,element:s,top:R,left:L,width:B,height:S,page:w+F})),e(s)&&K(n)}y==null||y(g,1),b==null||b(g,1);for(let s=0;s<V.length;s++){const h=d.children[s];X(h,s,V)}return await Promise.all(C),t.element.classList.remove(j.TransformingClassName),{pdf:g,pages:w}}async transformToPdfs(t){const d=t,{inOnePdf:n=!0,elements:e}=d,i=st(d,["inOnePdf","elements"]),r=[],a=await this.createPdfIfNotExisted(i.size);let c=0;for(let u=0;u<e.length;u++){u>0&&n&&a.addPage();const m=e[u],y=await this.createPdfIfNotExisted(i.size,n?a:void 0),{pdf:b,pages:k}=await this.transformToPdf(ot(rt({},i),{element:m,pdf:y,startPage:n?c:0}));c+=k,r.push(b)}return n?[r[0]]:r}};let U=j;_(U,"TransformingClassName","dom-to-pdf-transforming");const dt=o=>{const t=St.exports.useMemo(()=>{const n=()=>Math.round(Math.random()*255),e=[];for(let i=0;i<11;i++)e.push(`rgb(${n()}, ${n()}, ${n()})`);return e},[]);return v("div",{className:"print-layer a4",id:o.id,children:[l("div",{className:"text-24px h-24px font-500 text-[#333] text-center mt-10px bg-red-400",children:"dom-to-pdf"}),t.map((n,e)=>l("div",{className:"border-1px border-solid border-[#000]",style:{backgroundColor:n,height:"60px",marginTop:5,marginBottom:15,lineHeight:"60px"},children:e},e)),v("table",{className:"pdf-table",children:[l("thead",{children:v("tr",{children:[l("th",{children:"title"}),l("th",{children:"content"}),l("th",{children:"index"})]})}),l("tbody",{children:t.map((n,e)=>v("tr",{children:[l("td",{colSpan:1,children:n}),l("td",{colSpan:1,children:l("div",{className:"w-100px mx-auto h-35px",style:{backgroundColor:n}})}),l("td",{colSpan:1,children:e})]}))})]}),t.map((n,e)=>l("div",{className:"border-1px border-solid border-[#000]",style:{backgroundColor:n,height:"60px",marginTop:5,marginBottom:15,lineHeight:"60px"},children:e},e+"-next")),v("div",{className:"text-15px h-24px font-500 text-[#333] my-10px border-1px border-solid border-[#ccc] border-l-0 border-r-0 py-20px flex items-center justify-between",children:[l("span",{children:"\u8FD9\u662F\u4E00\u4E2Afooter"}),l("span",{children:new Date().toDateString()})]})]})},Rt=()=>{const o=async()=>await new U().transformToPdfs({elements:[document.getElementById("test"),document.getElementById("test1")],padding:[0,10,5,10],renderPageHeader:(r,a)=>{r.setTextColor("#111").setFontSize(8).text(`\u9875\u7709${a}`,10,4)},renderPageFooter:(r,a)=>{r.setTextColor("#111").setFontSize(8).text(`\u7B2C${a}\u9875`,r.internal.pageSize.getWidth()-17,r.internal.pageSize.getHeight()-1)}});return v("div",{id:"print-container",children:[l(dt,{id:"test"}),l(dt,{id:"test1"}),v("div",{className:"flex justify-center mb-10vh space-x-25px",children:[l(at,{type:"primary",onClick:async()=>{const e=await o();for(const i of e)i.save("test")},children:"\u4E0B\u8F7D"}),l(at,{type:"primary",onClick:async()=>{var i;const e=await o();for(const r of e){const a=window.open(),c=document.createElement("iframe");c.hidden=!0,c.src=URL.createObjectURL(r.output("blob")),a.document.body.appendChild(c),(i=c.contentWindow)==null||i.print()}},children:"\u6253\u5370"})]})]})};vt.render(l(Ct.StrictMode,{children:l(Rt,{})}),document.getElementById("root"));
