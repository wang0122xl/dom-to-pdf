var wt=Object.defineProperty,Et=Object.defineProperties;var xt=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var it=Object.prototype.hasOwnProperty,ot=Object.prototype.propertyIsEnumerable;var q=(s,t,n)=>t in s?wt(s,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[t]=n,rt=(s,t)=>{for(var n in t||(t={}))it.call(t,n)&&q(s,n,t[n]);if(j)for(var n of j(t))ot.call(t,n)&&q(s,n,t[n]);return s},st=(s,t)=>Et(s,xt(t));var U=(s,t)=>{var n={};for(var e in s)it.call(s,e)&&t.indexOf(e)<0&&(n[e]=s[e]);if(s!=null&&j)for(var e of j(s))t.indexOf(e)<0&&ot.call(s,e)&&(n[e]=s[e]);return n};var _=(s,t,n)=>(q(s,typeof t!="symbol"?t+"":t,n),n);import{E as Tt,t as Pt,r as St,j as v,a as c,B as lt,R as vt,b as Ct}from"./vendor.d569c6c0.js";const Nt=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))e(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&e(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function e(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}};Nt();const Lt="modulepreload",at={},Ft="/dom-to-pdf/",Bt=function(t,n){return!n||n.length===0?t():Promise.all(n.map(e=>{if(e=`${Ft}${e}`,e in at)return;at[e]=!0;const i=e.endsWith(".css"),o=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${o}`))return;const l=document.createElement("link");if(l.rel=i?"stylesheet":Lt,i||(l.as="script",l.crossOrigin=""),l.href=e,document.head.appendChild(l),i)return new Promise((m,d)=>{l.addEventListener("load",m),l.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${e}`)))})})).then(()=>t())},ct={width:210,height:297},Rt=s=>s.classList.contains("pdf-seperator"),At=s=>s.classList.contains("pdf-table"),k=class{constructor(){_(this,"heitiString")}async loadFont(){const{heitiString:t}=await Bt(()=>import("./heiti.2a8baa51.js"),[]);this.heitiString=t}async createPdfIfNotExisted(t,n){let e=n;const i=t||ct;return this.heitiString||await this.loadFont(),e||(e=new Tt("p","mm",[i.width,i.height]),e.addFileToVFS("heiti.ttf",this.heitiString),e.addFont("heiti.ttf","heiti","normal"),e.setFont("heiti")),e}async promisifyCreateImage(t){return new Promise(n=>{const e=document.createElement("img");e.src=t,e.onload=function(){n(e)}})}objectIs(t,n){return Object.prototype.toString.call(t)===`[object ${n}]`}recursiveFindClass(t,n,e){return t?this.objectIs(t,n)?t:this.recursiveFindClass(t.parentElement,n,e):null}recursiveFindTagName(t,n,e){return t?t.tagName===n?t:this.recursiveFindTagName(t.parentElement,n,e):null}async pdfAddEle(t){return Promise.resolve().then(()=>{const n=t.element.style.marginTop,e=t.element.style.marginBottom;return t.element.style.marginTop="0",t.element.style.marginBottom="0",Pt(t.element,{quality:1}).then(i=>this.promisifyCreateImage(i)).then(i=>{t.pdf.setPage(t.page),t.element.style.marginTop=n,t.element.style.marginBottom=e;const o=document.createElement("canvas");o.width=i.width*2,o.height=i.height*2;const l=o.getContext("2d");l.fillStyle="#fff",l.fillRect(0,0,o.width,o.height),l.drawImage(i,0,0,o.width,o.height);const m=o.toDataURL("image/jpeg",1);console.log(t),t.pdf.addImage(m,"JPEG",t.left,t.top,t.width,t.height)})})}async transformToPdf(t){if(!t.element)throw console.error("element is "+t.element),"element is "+t.element;const n=this;t.element.classList.add(k.TransformingClassName);const{isSeperatorCallback:e=Rt,isPdfTableCallback:i=At,lastElementOnBottom:o=!0,firstElementAsHeader:l=!0,lastElementAsFooter:m=!0,element:d,size:p=ct,padding:f=[0,0,0,0],renderPageHeader:b,renderPageFooter:w,stickyTableHeader:H=!0,startPage:C=0}=t,F=p.width-f[1]-f[3],$=d.getBoundingClientRect();let y=0;const B=f[3],W=d.children;if(d.children.length<2)throw new Error(`element: ${d} has less than 2 child nodes`);const D=d.children[0],ht=d.children[1],Y=d.children[d.children.length-1],ft=d.children[d.children.length-2],{y:R,height:z}=x(D),{y:mt,height:A}=x(Y),{y:G,height:Ot}=x(ht),{y:ut,height:gt}=x(ft),J=mt-ut-gt,pt=G-R-z;let E=1;const u=await this.createPdfIfNotExisted(p,t.pdf);function x(r){const a=r.getBoundingClientRect();return{y:P(a.top),height:P(a.height),width:P(a.width)}}function K(){y=R-P($.top)+f[0]}function P(r){return p.width/$.width*r}function yt(r){const a=r===D,h=r===Y,T=x(r);let g=T.height+f[0]+f[2];if(l&&!a&&(g+=z+R-P($.top)+pt),m&&!h&&(g+=J+A),g>p.height)throw console.error(r),new Error("element \u8D85\u51FApdf\u6700\u5927\u9AD8\u5EA6");let S=y+T.height+f[2];return m&&(S+=A+J),p.height-S}function Q(r,a,h){if(m&&N.push(r.pdfAddEle({pdf:u,element:Y,top:X,left:B,width:F,height:A,page:E+C})),E++,u.addPage(),K(),b==null||b(u,E),w==null||w(u,E),l&&(N.push(r.pdfAddEle({pdf:u,element:D,top:y,left:B,width:F,height:z,page:E+C})),y+=G-R),a&&r.objectIs(h,"HTMLTableRowElement")&&H&&!!!r.recursiveFindTagName(h,"THEAD",h)){const g=r.recursiveFindClass(h,"HTMLTableElement",h),S=g.querySelector("thead > tr"),M=g.querySelector("tbody > tr"),{y:tt,height:et}=x(S),{y:I}=x(M);N.push(r.pdfAddEle({pdf:u,element:S,top:y,left:B,width:F,height:et,page:E+C})),y+=I-tt}}K();const N=[],X=p.height-f[2]-A;function Z(r,a,h,T,g){const{height:S,y:M}=x(r);if(Object.prototype.toString.call(r)==="[object HTMLTableElement]"&&i(r)){let nt;const L=r.querySelectorAll("tr");a<h.length-1&&(nt=P(h[a+1].getBoundingClientRect().top-L[L.length-1].getBoundingClientRect().top));for(let O=0;O<L.length;O++){const bt=L[O];Z(bt,O,L,!0,nt)}return}yt(r)<0&&Q(n,T,r);let I=y;a<h.length-1?y+=P(h[a+1].getBoundingClientRect().top)-M:T&&(y+=g||0),a===h.length-1&&!T&&(m||o)&&(I=X),N.push(n.pdfAddEle({pdf:u,element:r,top:I,left:B,width:F,height:S,page:E+C})),e(r)&&Q(n)}b==null||b(u,1),w==null||w(u,1);for(let r=0;r<W.length;r++){const a=d.children[r];Z(a,r,W)}return await Promise.all(N),t.element.classList.remove(k.TransformingClassName),{pdf:u,pages:E,doPrint:(r=!0)=>{var g;let a=document.createElement("iframe");a.hidden=!0;const h=URL.createObjectURL(u.output("blob"));a.src=h,(r?window.open():window).document.body.appendChild(a),(g=a.contentWindow)==null||g.print(),URL.revokeObjectURL(h)}}}async transformToPdfs(t){const d=t,{inOnePdf:n=!0,elements:e}=d,i=U(d,["inOnePdf","elements"]),o=[],l=await this.createPdfIfNotExisted(i.size);let m=0;for(let f=0;f<e.length;f++){f>0&&n&&l.addPage();const b=e[f],w=await this.createPdfIfNotExisted(i.size,n?l:void 0),p=await this.transformToPdf(st(rt({},i),{element:b,pdf:w,startPage:n?m:0})),{pages:H}=p,C=U(p,["pages"]);m+=H,o.push(C)}return n?[o[0]]:o}};let V=k;_(V,"TransformingClassName","dom-to-pdf-transforming");const dt=s=>{const t=St.exports.useMemo(()=>{const n=()=>Math.round(Math.random()*255),e=[];for(let i=0;i<11;i++)e.push(`rgb(${n()}, ${n()}, ${n()})`);return e},[]);return v("div",{className:"print-layer a4",id:s.id,children:[c("div",{className:"text-24px h-24px font-500 text-[#333] text-center mt-10px bg-red-400",children:"dom-to-pdf"}),t.map((n,e)=>c("div",{className:"border-1px border-solid border-[#000]",style:{backgroundColor:n,height:"60px",marginTop:5,marginBottom:15,lineHeight:"60px"},children:e},e)),v("table",{className:"pdf-table",children:[c("thead",{children:v("tr",{children:[c("th",{children:"title"}),c("th",{children:"content"}),c("th",{children:"index"})]})}),c("tbody",{children:t.map((n,e)=>v("tr",{children:[c("td",{colSpan:1,children:n}),c("td",{colSpan:1,children:c("div",{className:"w-100px mx-auto h-35px",style:{backgroundColor:n}})}),c("td",{colSpan:1,children:e})]}))})]}),t.map((n,e)=>c("div",{className:"border-1px border-solid border-[#000]",style:{backgroundColor:n,height:"60px",marginTop:5,marginBottom:15,lineHeight:"60px"},children:e},e+"-next")),v("div",{className:"text-15px h-24px font-500 text-[#333] my-10px border-1px border-solid border-[#ccc] border-l-0 border-r-0 py-20px flex items-center justify-between",children:[c("span",{children:"\u8FD9\u662F\u4E00\u4E2Afooter"}),c("span",{children:new Date().toDateString()})]})]})},It=()=>{const s=async()=>await new V().transformToPdfs({elements:[document.getElementById("test"),document.getElementById("test1")],padding:[0,10,5,10],renderPageHeader:(o,l)=>{o.setTextColor("#111").setFontSize(8).text(`\u9875\u7709${l}`,10,4)},renderPageFooter:(o,l)=>{o.setTextColor("#111").setFontSize(8).text(`\u7B2C${l}\u9875`,o.internal.pageSize.getWidth()-17,o.internal.pageSize.getHeight()-1)}});return v("div",{id:"print-container",children:[c(dt,{id:"test"}),c(dt,{id:"test1"}),v("div",{className:"flex justify-center mb-10vh space-x-25px",children:[c(lt,{type:"primary",onClick:async()=>{const e=await s();for(const i of e)i.pdf.save("test")},children:"\u4E0B\u8F7D"}),c(lt,{type:"primary",onClick:async()=>{const e=await s();for(const i of e)i.doPrint(!1)},children:"\u6253\u5370"})]})]})};vt.render(c(Ct.StrictMode,{children:c(It,{})}),document.getElementById("root"));
